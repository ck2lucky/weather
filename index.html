<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <title>실시간 날씨 정보 받아오기</title>
</head>
<body>
    <div class="weather">

    </div>

    <script>
        /* 
        날씨 키값(api key)
        02a146d88b51a0a88235d8a46514d112
        
        도시 코드
        1841066
        
        날씨 예보
        http://api.openweathermap.org/data/2.5/forecast?id=524901&appid={API key}
        http://api.openweathermap.org/data/2.5/forecast?id=1841066&appid=02a146d88b51a0a88235d8a46514d112&units=metric

        현재시간 날씨
        http://api.openweathermap.org/data/2.5/weather?id=2172797&appid={API key}
        http://api.openweathermap.org/data/2.5/weather?id=1841066&appid=02a146d88b51a0a88235d8a46514d112&units=metric

        json 코드 이쁘게 변환
        https://jsonbeautifier.org/

        {
            "dt":1630227600,
            "main":{
                "temp":27.03,
                "feels_like":30.71,
                "temp_min":25.54,
                "temp_max":27.03,
                "pressure":1013,
                "sea_level":1013,
                "grnd_level":1012,
                "humidity":89,
                "temp_kf":1.49
            },
            "weather":[
                {
                    "id":804,
                    "main":"Clouds",
                    "description":"overcast clouds",
                    "icon":"04d"
                }
            ],
            "clouds":{
                "all":95
            },
            "wind":{
                "speed":2.66,
                "deg":251,
                "gust":3.38
            },
            "visibility":10000,
            "pop":0.16,
            "sys":{
                "pod":"d"
            },
            "dt_txt":"2021-08-29 09:00:00"
        }
        */

        /* 
        $.getJSON('URL',function(data){
            //data로 할일
        });
         */
        /* 
        날씨 아이콘 경로    
            http://openweathermap.org/img/wn/10d@2x.png
        */
       
        var weather = document.querySelector(".weather");
        var wIcon;

        // 날씨 예보
        //  $.getJSON('http://api.openweathermap.org/data/2.5/forecast?id=1841066&appid=02a146d88b51a0a88235d8a46514d112&units=metric',function(data){
        //     var time =new Date(data.list[0].dt*1000);
        //     weather.innerHTML += time + " ";
        //     weather.innerHTML += data.city.name + " ";
        //     weather.innerHTML += data.city.country + " ";
        //     weather.innerHTML += data.list[0].main.temp + "도 ";
        //     weather.innerHTML += `<img src='http://openweathermap.org/img/wn/${data.list[0].weather[0].icon}@2x.png'>`;
        // });

        // 현재 날씨
        // $.getJSON('http://api.openweathermap.org/data/2.5/weather?id=1841066&appid=02a146d88b51a0a88235d8a46514d112&units=metric',function(data){
        //     var time =new Date(data.dt*1000);
        //     weather.innerHTML += time + " ";
        //     weather.innerHTML += data.name + " ";
        //     weather.innerHTML += data.sys.country + " ";
        //     weather.innerHTML += data.main.temp + "도 ";
        //     weather.innerHTML += `<img src='http://openweathermap.org/img/wn/${data.weather[0].icon}.png'>`;
        // });

        var requestURL = 'http://api.openweathermap.org/data/2.5/weather?id=1841066&appid=02a146d88b51a0a88235d8a46514d112&units=metric';
        var xhr = new XMLHttpRequest();
        xhr.open('GET', requestURL);
        xhr.responseType='json';
        xhr.onload = function() {
            var data = xhr.response;
            var time =new Date(data.dt*1000);
            weather.innerHTML += time + " ";
            weather.innerHTML += data.name + " ";
            weather.innerHTML += data.sys.country + " ";
            weather.innerHTML += data.main.temp + "도 ";
            weather.innerHTML += `<img src='http://openweathermap.org/img/wn/${data.weather[0].icon}.png'>`;
        };
        xhr.send();
    </script> 
     
</body>
</html>